library(ggplot2)
library(dplyr)
gwas.aud = tibble(read.csv("Alcohol_dependency_asso.tsv",
header = T,
sep = "\t"))
gwas.adhd = tibble(read.csv("ADHD_asso.tsv",
header = T,
sep = "\t"))
gwas.adhd
gwas.aud.gene = gwas.aud %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue) %>%
mutate(gene = strsplit(mappedGenes, ","))
gwas.adhd.gene = gwas.adhd %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue) %>%
mutate(gene = strsplit(mappedGenes, ","))
overlap_gene = intersect(unique(unlist(gwas.aud.gene$gene)),
unique(unlist(gwas.adhd.gene$gene)))
a = gwas.aud.gene %>%
filter(gene %in% overlap_gene)
overlap_gene
gwas.adhd.gene
gwas.aud.gene %>%
filter(gene %in% overlap_gene)
overlap_gene
print(a, n=28)
print(a, n=48)
gwas.adhd.gene %>%
filter(gene %in% overlap_gene)
a = gwas.adhd.gene %>%
filter(gene %in% overlap_gene)
print(a, n=80)
gwas.adhd
View(gwas.adhd)
View(gwas.adhd.gene)
View(gwas.adhd)
View(gwas.adhd)
library(ggplot2)
library(dplyr)
gwas.aud = tibble(read.csv("Alcohol_dependency_asso.tsv",
header = T,
sep = "\t"))
gwas.adhd = tibble(read.csv("ADHD_asso.tsv",
header = T,
sep = "\t"))
gwas.aud.gene = gwas.aud %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue, accessionId) %>%
mutate(gene = strsplit(mappedGenes, ","))
gwas.adhd.gene = gwas.adhd %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue, accessionId) %>%
mutate(gene = strsplit(mappedGenes, ","))
overlap_gene = intersect(unique(unlist(gwas.aud.gene$gene)),
unique(unlist(gwas.adhd.gene$gene)))
gwas.adhd.gene
gwas.aud.gene %>%
filter(gene %in% overlap_gene)
aud.overlap = gwas.aud.gene %>%
filter(gene %in% overlap_gene)
adhd.overlap = gwas.adhd.gene %>%
filter(gene %in% overlap_gene)
View(adhd.overlap)
aud.overlap = gwas.aud.gene %>%
filter(gene %in% overlap_gene) %>%
mutate(disease = "ADHD")
aud.overlap = gwas.aud.gene %>%
filter(gene %in% overlap_gene) %>%
mutate(disease = "AUD")
adhd.overlap = gwas.adhd.gene %>%
filter(gene %in% overlap_gene) %>%
mutate(disease = "ADHD")
data.overlap = cbind(aud.overlap, adhd.overlap)
data.overlap = rbind(aud.overlap, adhd.overlap)
View(data.overlap)
unique(data.overlap$accessionId)
write(unique(data.overlap$accessionId), "studyID.csv")
library(ggplot2)
library(dplyr)
gwas.sud = tibble(read.csv("SUD_asso.tsv",
header = T,
sep = "\t"))
gwas.adhd = tibble(read.csv("ADHD_asso.tsv",
header = T,
sep = "\t"))
gwas.sud.gene = gwas.sud %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue, accessionId) %>%
mutate(gene = strsplit(mappedGenes, ","))
gwas.adhd.gene = gwas.adhd %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue, accessionId) %>%
mutate(gene = strsplit(mappedGenes, ","))
rm(list = ls())
library(ggplot2)
library(dplyr)
gwas.sud = tibble(read.csv("SUD_asso.tsv",
header = T,
sep = "\t"))
gwas.adhd = tibble(read.csv("ADHD_asso.tsv",
header = T,
sep = "\t"))
gwas.sud
View(gwas.sud)
gwas.sud.gene = gwas.sud %>%
filter(MAPPED_GENE != "") %>%
select(riskAllele, mappedGenes, pValue, accessionId) %>%
mutate(gene = strsplit(mappedGenes, ","))
gwas.sud.gene = gwas.sud %>%
filter(MAPPED_GENE != "") %>%
select(STRONGEST.SNP.RISK.ALLELE, MAPPED_GENE, P.VALUE, STUDY.ACCESSION) %>%
mutate(gene = strsplit(MAPPED_GENE, ","))
gwas.adhd.gene = gwas.adhd %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue, accessionId) %>%
mutate(gene = strsplit(mappedGenes, ","))
gwas.sud.gene = gwas.sud %>%
filter(MAPPED_GENE != "") %>%
select(STRONGEST.SNP.RISK.ALLELE, MAPPED_GENE, P.VALUE, STUDY.ACCESSION) %>%
mutate(gene = strsplit(MAPPED_GENE, ","))
gwas.adhd.gene = gwas.adhd %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue, accessionId) %>%
mutate(gene = strsplit(mappedGenes, ","))
gwas.sud.gene
gwas.adhd.gene
overlap_gene = intersect(unique(unlist(gwas.sud.gene$gene)),
unique(unlist(gwas.adhd.gene$gene)))
sud.overlap = gwas.sud.gene %>%
filter(gene %in% overlap_gene) %>%
mutate(disease = "SUD")
adhd.overlap = gwas.adhd.gene %>%
filter(gene %in% overlap_gene) %>%
mutate(disease = "ADHD")
sud.overlap
View(sud.overlap)
overlap_gene
data.overlap = rbind(sud.overlap, adhd.overlap)
gwas.adhd.gene
gwas.sud.gene
names(gwas.sud.gene) = c("riskAllele", "mappedGenes", "pValue", "accessionId")
gwas.sud.gene
gwas.sud.gene = gwas.sud %>%
filter(MAPPED_GENE != "") %>%
select(STRONGEST.SNP.RISK.ALLELE, MAPPED_GENE, P.VALUE, STUDY.ACCESSION) %>%
mutate(gene = strsplit(MAPPED_GENE, ","))
names(gwas.sud.gene) = c("riskAllele", "mappedGenes", "pValue", "accessionId")
gwas.adhd.gene = gwas.adhd %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue, accessionId) %>%
mutate(gene = strsplit(mappedGenes, ","))
overlap_gene = intersect(unique(unlist(gwas.sud.gene$gene)),
unique(unlist(gwas.adhd.gene$gene)))
sud.overlap = gwas.sud.gene %>%
filter(gene %in% overlap_gene) %>%
mutate(disease = "SUD")
adhd.overlap = gwas.adhd.gene %>%
filter(gene %in% overlap_gene) %>%
mutate(disease = "ADHD")
gwas.sud.gene = gwas.sud %>%
filter(MAPPED_GENE != "") %>%
select(STRONGEST.SNP.RISK.ALLELE, MAPPED_GENE, P.VALUE, STUDY.ACCESSION) %>%
mutate(gene = strsplit(MAPPED_GENE, ","))
names(gwas.sud.gene) = c("riskAllele", "mappedGenes", "pValue", "accessionId","gene")
gwas.adhd.gene = gwas.adhd %>%
filter(mappedGenes != "-") %>%
select(riskAllele, mappedGenes, pValue, accessionId) %>%
mutate(gene = strsplit(mappedGenes, ","))
overlap_gene = intersect(unique(unlist(gwas.sud.gene$gene)),
unique(unlist(gwas.adhd.gene$gene)))
sud.overlap = gwas.sud.gene %>%
filter(gene %in% overlap_gene) %>%
mutate(disease = "SUD")
adhd.overlap = gwas.adhd.gene %>%
filter(gene %in% overlap_gene) %>%
mutate(disease = "ADHD")
data.overlap = rbind(sud.overlap, adhd.overlap)
data.overlap
unique(data.overlap$accessionId)
write.csv(data.overlap, "data.overlap.csv")
write.csv(select(data.overlap, -gene), "data.overlap.csv")
write.csv(unique(data.overlap$accessionId))
write.csv(unique(data.overlap$accessionId),"overlap_gene.csv")
write.csv(select(data.overlap, -gene), "data.overlap.csv")
write.csv(unique(data.overlap$accessionId),"studyID.csv")
install.packages("metafor")
library(metafor)
tibble(read.csv("studyData/GCST90016595_buildGRCh37.tsv"))
data1 =
tibble(read.table("studyData/GCST90016595_buildGRCh37.tsv"))
data1
data1 = tibble(read.csv("studyData/GCST90016595_buildGRCh37.tsv", sep = "\t"))
data1
data1 = tibble(read.csv("studyData/GCST90016595_buildGRCh37.tsv", sep = "\t"))
data2 = tibble(read.csv("studyData/GCST90016604_buildGRCh37.tsv", sep = "\t"))
rm(list = ls())
data1 = tibble(read.csv("studyData/GCST90016595_buildGRCh37.tsv", sep = "\t"))
data2 = tibble(read.csv("studyData/GCST90016604_buildGRCh37.tsv", sep = "\t"))
View(data1)
data1
data2
combined_data = merge(data1, data2, by="variant_id", suffixes=c(".study1", ".study2"))
combined_data
View(combined_data)
meta_results = rma(yi = cbind(beta.study1, beta.study2),
vi = cbind(standard_error.study1^2, standard_error.study2^2),
data = combined_data,
method = "FE")
meta_results = rma(yi = cbind(beta.study1, beta.study2),
vi = cbind(standard_error.study1^2, standard_error.study2^2),
data = combined_data,
method = "FE")
?rma
Error in rma(yi = cbind(beta.study1, beta.study2), vi = cbind(standard_error.study1^2,  :
dat <- escalc(measure="RR", ai=tpos, bi=tneg, ci=cpos, di=cneg, data=dat.bcg)
dat
rma(yi, vi, data=dat, method="REML")
forest(rma(yi, vi, data=dat, method="REML"))
data1
combined_data
combined_data = tibble(combined_data)
combined_data
escalc("OR", ai=beta.study1, bi=beta.study2, data=combined_data)
?rma
data1
data1
View(data1)
