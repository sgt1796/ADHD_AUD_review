data3
data2
formatted_data1 = data1
formatted_data2 = data2
# Save the formatted data
write.table(formatted_data1, "studyData/processed_files/GCST012597_buildGRCh37_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
# Save the formatted data
write.table(formatted_data2, "studyData/processed_files/GCST007543_daner_meta_filtered_NA_iPSYCH23_PGC11_sigPCs_woSEX_2ell6sd_EUR_Neff_70_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
# Save the formatted data
write.table(formatted_data1, "studyData/processed_files/GCST007543_daner_meta_filtered_NA_iPSYCH23_PGC11_sigPCs_woSEX_2ell6sd_EUR_Neff_70_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
write.table(formatted_data2, "studyData/processed_files/GCST008414_CUD_GWAS_iPSYCH_June2019_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
data1 = tibble(read.csv("studyData/files/GCST012597_buildGRCh37.tsv", sep = "\t"))
data2 = tibble(read.csv("studyData/files/GCST005362_buildGRCh37.tsv", sep = " "))
data2 = tibble(read.csv("studyData/files/GCST005362_buildGRCh37.tsv", sep = "\t"))
data1
data2
formatted_data1 = data1 %>%
dplyr::select(
SNP = variant_id,
CHR = chromosome,
BP = base_pair_location,
A1 = effect_allele,
A2 = other_allele,
OR = beta,  # assuming that 'beta' represents the odds ratio here
SE = standard_error,
P = p_value
)
formatted_data2 = data2 %>%
dplyr::select(
SNP = variant_id,
CHR = chromosome,
BP = base_pair_location,
A1 = effect_allele,
A2 = other_allele,
OR = beta,  # assuming that 'beta' represents the odds ratio here
SE = standard_error,
P = p_value
)
write.table(formatted_data1, "studyData/processed_files/GCST012597_buildGRCh37_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
write.table(formatted_data2, "studyData/processed_files/GCST005362_buildGRCh37_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
list.files("studyData/processed_files")
list.files("studyData/files")
data1 = tibble(read.csv("studyData/files/GCST012093_daner_natgen_pgc_eur", sep = "\t"))
data2 = tibble(read.csv("studyData/files/GCST012093_daner_PGC_BIP32b_mds7a_0416a", sep = "\t"))
data1
data2
data1 = tibble(read.csv("studyData/files/GCST012093_daner_natgen_pgc_eur", sep = ""))
data1 = tibble(read.csv("studyData/files/GCST012093_daner_natgen_pgc_eur", sep = " "))
data1
data2
# Save the formatted data
write.table(formatted_data1, "studyData/processed_files/GCST012093_daner_natgen_pgc_eur_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
write.table(formatted_data2, "studyData/processed_files/GCST012093_daner_PGC_BIP32b_mds7a_0416a_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
list.files("studyData/processed_files")
data1 = tibble(read.csv("studyData/files/GCST012093_iPSYCH-PGC_ASD_Nov2017", sep = " "))
data2 = tibble(read.csv("studyData/files/GCST012093_PGC_UKB_depression_genome-wide.txt", sep = "\t"))
data1
data2
data1 = tibble(read.csv("studyData/files/GCST012093_iPSYCH-PGC_ASD_Nov2017", sep = "\t"))
data2 = tibble(read.csv("studyData/files/GCST012093_PGC_UKB_depression_genome-wide.txt", sep = " "))
data1
data2
data1
data2
formatted_data1 = data1
# Save the formatted data
write.table(formatted_data1, "studyData/processed_files/GCST012093_iPSYCH-PGC_ASD_Nov2017_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
list.files("studyData/files")
data1 = tibble(read.csv("studyData/files/GCST012093_daner_natgen_pgc_eur", sep = " "))
data2 = tibble(read.csv("studyData/files/GCST012093_daner_PGC_BIP32b_mds7a_0416a", sep = "\t"))
data1
data2
formatted_data1 = data1
formatted_data2 = data2
# Save the formatted data
write.table(formatted_data1, "studyData/processed_files/GCST012093_daner_natgen_pgc_eur_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
write.table(formatted_data2, "studyData/processed_files/GCST012093_daner_PGC_BIP32b_mds7a_0416a_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
data1 = tibble(read.csv("GCST007543_daner_meta_filtered_NA_iPSYCH23_PGC11_sigPCs_woSEX_2ell6sd_EUR_Neff_70.meta", sep = "\t"))
data2 = tibble(read.csv("GCST008414_CUD_GWAS_iPSYCH_June2019.tsv", sep = "\t"))
data1 = tibble(read.csv("studyData/files/GCST007543_daner_meta_filtered_NA_iPSYCH23_PGC11_sigPCs_woSEX_2ell6sd_EUR_Neff_70.meta", sep = "\t"))
data2 = tibble(read.csv("studyData/files/GCST008414_CUD_GWAS_iPSYCH_June2019.tsv", sep = "\t"))
data1
data1
data2
data2 = tibble(read.csv("studyData/files/GCST008414_CUD_GWAS_iPSYCH_June2019.tsv", sep = " "))
data2
data1
list.files("studyData/processed_files")
## Meta-analysis
library(dplyr)
library(qqman)
data = tibble(read.table("studyData/plink/plink.meta", header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
data1 = filter(data, N >=7 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/8)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
manhattan(data1,annotatePval = 1e-8, main = "Manhattan Plot", ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R." )
filter(data1, CHR = 18)
filter(data1, CHR == 18)
filter(data1, CHR == 18, P.R. <= 1e-5)
a = filter(data1, CHR == 18, P.R. <= 1e-5)
# query url, cannot query too many or will out of memory
response = GET(paste0("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=snp&id=", paste(a$SNP, collapse = ",")))
## generate SNPdb query url
library(xml2)
library(httr)
library(stringr)
# query url, cannot query too many or will out of memory
response = GET(paste0("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=snp&id=", paste(a$SNP, collapse = ",")))
xml_content <- content(response, as = "text")
xml_content <- sub("<?xml[^>]*?>", "", xml_content)
xml_content <- paste("<root>", xml_content, "</root>")
xml_doc <- read_xml(xml_content)
gnames = c()
for (record in xml_children(xml_doc)){
gname <- xml_text(xml_find_first(record, ".//NAME"))
gnames = c(gnames, gname)
}
data.gname = data.high %>%
mutate(GENE = gnames) %>%
select(CHR, BP, SNP, A1, A2, N, P = P.R., OR = OR.R., GENE)
gnames
a
manhattan(data1,annotatePval = 1e-8, main = "Manhattan Plot", ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.", hightligh = c("rs149661977") )
manhattan(data1,annotatePval = 1e-8, main = "Manhattan Plot", ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.", highlight = c("rs149661977") )
manhattan(data1,annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.", highlight = c("rs149661977") )
## Q-Q plot for the selected data
qq(data1$P.R.^8)
## Q-Q plot for the selected data
qq(data1$P.R.^8, xlim = c(0,3))
## Q-Q plot for the selected data
qq(data1$P.R.^8, xlim = c(0,3), ylim = c(0,3))
## Q-Q plot for the selected data
qq(data1$P.R.^8, xlim = c(0,3), ylim = c(0,6))
## Q-Q plot for the selected data
qq(data1$P.R.^8, xlim = c(0,3), ylim = log(c(0,6)))
## Q-Q plot for the selected data
qq(data1$P.R.^8, xlim = c(0,3), ylim = log(c(0.000001,6)))
## Q-Q plot for the selected data
qq(data1$P.R.^8, xlim = c(0,1.5)))
## Q-Q plot for the selected data
qq(data1$P.R.^8, xlim = c(0,1.5))
## Q-Q plot for the selected data
qq(data1$P.R.^8)
data.high = data1 %>%
filter(P.R. <= 5e-8)
## generate SNPdb query url
library(xml2)
library(httr)
library(stringr)
# query url, cannot query too many or will out of memory
response = GET(paste0("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=snp&id=", paste(data.high$SNP, collapse = ",")))
xml_content <- content(response, as = "text")
xml_content <- sub("<?xml[^>]*?>", "", xml_content)
xml_content <- paste("<root>", xml_content, "</root>")
xml_doc <- read_xml(xml_content)
gnames = c()
for (record in xml_children(xml_doc)){
gname <- xml_text(xml_find_first(record, ".//NAME"))
gnames = c(gnames, gname)
}
data.gname = data.high %>%
mutate(GENE = gnames) %>%
select(CHR, BP, SNP, A1, A2, N, P = P.R., OR = OR.R., GENE)
arrange(data.gname, desc(OR))
write(arrange(data.gname, desc(OR)), "result.csv")
a = arrange(data.gname, desc(OR))
write(a, "result.csv")
a
a = tibble(arrange(data.gname, desc(OR)))
write(a, "result.csv")
write.csv(a, "result.csv")
a = tibble(arrange(data.gname, desc(CHR)))
a
a = tibble(arrange(data.gname, CHR))
write.csv(a, "result.csv")
tibble(arrange(data.gname, CHR))
?manhattan
manhattan(data1,annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.", highlight = c("rs149661977") )
filter(data1, CHR == 11, BP >= 630000 & BP <= 641000)
filter(data, CHR == 11, BP >= 630000 & BP <= 641000)
filter(data, CHR == 11, BP >= 637269 & BP <= 640706)
a = filter(data, CHR == 11, BP >= 637269 & BP <= 640706)
# query url, cannot query too many or will out of memory
response = GET(paste0("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=snp&id=", paste(a$SNP, collapse = ",")))
xml_content <- content(response, as = "text")
xml_content <- sub("<?xml[^>]*?>", "", xml_content)
xml_content <- paste("<root>", xml_content, "</root>")
xml_doc <- read_xml(xml_content)
gnames = c()
for (record in xml_children(xml_doc)){
gname <- xml_text(xml_find_first(record, ".//NAME"))
gnames = c(gnames, gname)
}
data.gname = a %>%
mutate(GENE = gnames) %>%
select(CHR, BP, SNP, A1, A2, N, P = P.R., OR = OR.R., GENE)
data.gname
a
# query url, cannot query too many or will out of memory
response = GET(paste0("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=snp&id=", paste(a$SNP, collapse = ",")))
xml_content <- content(response, as = "text")
xml_content <- sub("<?xml[^>]*?>", "", xml_content)
xml_content <- paste("<root>", xml_content, "</root>")
xml_doc <- read_xml(xml_content)
gnames = c()
for (record in xml_children(xml_doc)){
gname <- xml_text(xml_find_first(record, ".//NAME"))
gnames = c(gnames, gname)
}
gnames
manhattan(data1,annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.", highlight = c("rs149661977"), CHR = "11" )
manhattan(filter(data1, CHR==11),annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.", highlight = c("rs149661977") )
data.high = data1 %>%
filter(P.R. <= 5e-8)
## generate SNPdb query url
library(xml2)
library(httr)
library(stringr)
# query url, cannot query too many or will out of memory
response = GET(paste0("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=snp&id=", paste(data.high$SNP, collapse = ",")))
xml_content <- content(response, as = "text")
xml_content <- sub("<?xml[^>]*?>", "", xml_content)
xml_content <- paste("<root>", xml_content, "</root>")
xml_doc <- read_xml(xml_content)
gnames = c()
for (record in xml_children(xml_doc)){
gname <- xml_text(xml_find_first(record, ".//NAME"))
gnames = c(gnames, gname)
}
data.gname = data.high %>%
mutate(GENE = gnames) %>%
select(CHR, BP, SNP, A1, A2, N, P = P.R., OR = OR.R., GENE)
data.gname
# path = "studyData/plink/plink.meta"
path = "studyData/ncr_plink/plink_1.meta"
data = tibble(read.table(path, header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
## Meta-analysis
library(dplyr)
library(qqman)
# path = "studyData/plink/plink.meta"
path = "studyData/ncr_plink/plink_1.meta"
data = tibble(read.table(path, header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
data1 = filter(data, N >=7 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/8)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
manhattan(data1,annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
data1 = filter(data, N >=7 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/9)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
manhattan(data1,annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
manhattan(filter(data1, CHR==11),annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
# find location for the DRD4 gene
data.drd4 = filter(data1, CHR == 11, 637269 <= BP & BP <= 640706)
data.drd4
# find DRD2 gene
data.drd2 = filter(data1, CHR == 11, 113280327 <= BP & BP <= 113346120)
data.drd2
# path = "studyData/plink/plink.meta"
path = "studyData/ncr_plink/plink_2.meta"
data = tibble(read.table(path, header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
data1 = filter(data, N >=5 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/9)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
# find location for the DRD4 gene
data.drd4 = filter(data1, CHR == 11, 637269 <= BP & BP <= 640706)
# find DRD2 gene
data.drd2 = filter(data1, CHR == 11, 113280327 <= BP & BP <= 113346120)
data.drd2
manhattan(filter(data1, CHR==11),annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
# path = "studyData/plink/plink.meta"
path = "studyData/ncr_plink/plink_3.meta"
data = tibble(read.table(path, header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
data1 = filter(data, N >=5 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/9)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
# find location for the DRD4 gene
data.drd4 = filter(data1, CHR == 11, 637269 <= BP & BP <= 640706)
# find DRD2 gene
data.drd2 = filter(data1, CHR == 11, 113280327 <= BP & BP <= 113346120)
manhattan(filter(data1, CHR==11),annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
# path = "studyData/plink/plink.meta"
path = "studyData/ncr_plink/plink_4.meta"
data = tibble(read.table(path, header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
data1 = filter(data, N >=5 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/9)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
# find location for the DRD4 gene
data.drd4 = filter(data1, CHR == 11, 637269 <= BP & BP <= 640706)
# find DRD2 gene
data.drd2 = filter(data1, CHR == 11, 113280327 <= BP & BP <= 113346120)
drd2
data.drd2
manhattan(filter(data1, CHR==11),annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
# path = "studyData/plink/plink.meta"
path = "studyData/ncr_plink/plink_5.meta"
data = tibble(read.table(path, header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
data1 = filter(data, N >=5 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/9)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
# find location for the DRD4 gene
data.drd4 = filter(data1, CHR == 11, 637269 <= BP & BP <= 640706)
# find DRD2 gene
data.drd2 = filter(data1, CHR == 11, 113280327 <= BP & BP <= 113346120)
manhattan(data1,annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
manhattan(filter(data1, CHR==11),annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
# path = "studyData/plink/plink.meta"
path = "studyData/ncr_plink/plink_6.meta"
data = tibble(read.table(path, header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
data1 = filter(data, N >=5 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/9)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
# find location for the DRD4 gene
data.drd4 = filter(data1, CHR == 11, 637269 <= BP & BP <= 640706)
# find DRD2 gene
data.drd2 = filter(data1, CHR == 11, 113280327 <= BP & BP <= 113346120)
manhattan(data1,annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
# path = "studyData/plink/plink.meta"
path = "studyData/ncr_plink/plink_7.meta"
data = tibble(read.table(path, header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
data1 = filter(data, N >=5 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/9)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
# find location for the DRD4 gene
data.drd4 = filter(data1, CHR == 11, 637269 <= BP & BP <= 640706)
# find DRD2 gene
data.drd2 = filter(data1, CHR == 11, 113280327 <= BP & BP <= 113346120)
?manhattan
path = "studyData/plink/plink.meta"
# path = "studyData/ncr_plink/plink_7.meta"
data = tibble(read.table(path, header = T)) %>%
filter(P.R. != 0) %>%
tidyr::drop_na()
data1 = filter(data, N >=5 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/9)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
# find location for the DRD4 gene
data.drd4 = filter(data1, CHR == 11, 637269 <= BP & BP <= 640706)
# find DRD2 gene
data.drd2 = filter(data1, CHR == 11, 113280327 <= BP & BP <= 113346120)
data1 = filter(data, N >=5 & P.R. >= 1e-150 & P.R. != 0)%>%
mutate(P.R. = P.R.^(1/8)) %>%
#filter(P != 0) %>%
tidyr::drop_na()
# find location for the DRD4 gene
data.drd4 = filter(data1, CHR == 11, 637269 <= BP & BP <= 640706)
# find DRD2 gene
data.drd2 = filter(data1, CHR == 11, 113280327 <= BP & BP <= 113346120)
data.drd4
manhattan(data1,annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
manhattan(filter(data1, CHR==11),annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
manhattan(filter(data1, CHR==18),annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.")
manhattan(filter(data1, CHR==18),annotatePval = 1e-8, ylim = c(0, 10),  cex.axis = 0.9,
col = c("blue4", "orange3"), p = "P.R.", highlight = "rs149661977")
filter(data1, SNP == ""rs149661977"")
filter(data1, SNP == "rs149661977")
install.packages("humarray")
install.packages("Rtools")
library(Rtools)
BiocManager::install("Rtools")
install.packages("humarray")
BiocManager::install("humarray")
library(humarray)
library(dplyr)
library(stringr)
data1 = tibble(read.csv("studyData/files/PGC32099098_OD_cases_vs._opioid-exposed_controls_in_the_trans-ancestry_meta-analysis", sep = "\t"))
data2 = tibble(read.csv("studyData/files/PGC30482948_pgc_alcdep.discovery.aug2018_release.txt", sep = " "))
data2
data2.sm = data2[1:10,]
data2.sm %>%
mutate(SNP = strsplit(.,":")[1])
mutate(SNP = strsplit(SNP,":")[1])
data2.sm = data2[1:10,]
data2.sm %>%
mutate(SNP = strsplit(.,":")[1])
data2.sm %>%
mutate(SNP = strsplit(SNP,":")[1])
data2.sm %>%
mutate(SNP = strsplit(SNP,":")[1][1])
data2.sm %>%
mutate(SNP = unlist(strsplit(SNP,":"))[1])
data2.sm %>%
rowwise() %>%
mutate(SNP = unlist(strsplit(SNP,":"))[1])
data2 %>%
rowwise() %>%
mutate(SNP = unlist(strsplit(SNP,":"))[1])
formatted_data2 = data2 %>%
rowwise() %>%
mutate(SNP = unlist(strsplit(SNP,":"))[1]) %>%
dplyr::select(
SNP = SNP,
CHR = CHR,
BP = BP,
A1 = A1,
A2 = A2,
OR = Z,  # assuming that 'beta' represents the odds ratio here
SE = Weight,
P = P
)
formatted_data2
write.table(formatted_data2, "studyData/processed_files/PGC30482948_pgc_alcdep.discovery.aug2018_release_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
View(data1)
data1 = tibble(read.csv("PGC30336701_AUDIT_UKB_2018_AJP.txt", sep = "\t"))
data1 = tibble(read.csv("PGC30336701_AUDIT_UKB_2018_AJP.txt", sep = " "))
data1 = tibble(read.csv("studyData/files/PGC30336701_AUDIT_UKB_2018_AJP.txt", sep = " "))
data2
data1
View(data1)
data1 %>%
filter(str_detect(.$rsid, "^rs"))
formatted_data1 = data1 %>%
filter(str_detect(.$rsid, "^rs")) %>%
dplyr::select(
SNP = rsid,
CHR = chr,
#BP = base_pair_location,
A1 = a_1,
A2 = a_0,
OR = beta_P,  # assuming that 'beta' represents the odds ratio here
SE = se_P,
P = p_P
)
# Save the formatted data
write.table(formatted_data1, "studyData/processed_files/PGC30336701_AUDIT_UKB_2018_AJP_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
data2
data2 = tibble(read.csv("studyData/files/PGC32099098_OD_cases_vs._opioid-exposed_controls_in_the_trans-ancestry_meta-analysis", sep = "\t"))
data2
formatted_data2 = data2 %>%
#rowwise() %>%
#mutate(SNP = unlist(strsplit(SNP,":"))[1]) %>%
dplyr::select(
SNP = rsID,
#CHR = CHR,
#BP = BP,
A1 = Allele1,
A2 = Allele2,
OR = Zscore,  # assuming that 'beta' represents the odds ratio here
SE = Weight,
P = P.value
)
formatted_data2
write.table(formatted_data2, "studyData/processed_files/PGC30482948_pgc_alcdep.discovery.aug2018_release_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
write.table(formatted_data2, "studyData/processed_files/PGC32099098_OD_cases_vs._opioid-exposed_controls_in_the_trans-ancestry_meta-analysis_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
data1 = tibble(read.csv("studyData/files/PGC30482948_pgc_alcdep.discovery.aug2018_release.txt", sep = "\t"))
data1
data1 = tibble(read.csv("studyData/files/PGC30482948_pgc_alcdep.discovery.aug2018_release.txt", sep = " "))
data1
data2 = data1
data2 %>%
rowwise() %>%
mutate(SNP = unlist(strsplit(SNP,":"))[1])
formatted_data2 = data2 %>%
rowwise() %>%
mutate(SNP = unlist(strsplit(SNP,":"))[1]) %>%
dplyr::select(
SNP = SNP,
CHR = CHR,
BP = BP,
A1 = A1,
A2 = A2,
OR = Z,  # assuming that 'beta' represents the odds ratio here
SE = Weight,
P = P
)
write.table(formatted_data2, "studyData/processed_files/PGC30482948_pgc_alcdep.discovery.aug2018_release_processed.txt", sep = "\t", row.names = FALSE, quote = FALSE)
